general:
  artifacts:
    - "~/helloworld.o"
machine:
  services:
    - docker
  environment:
    toolset_branch: master
    server_type: circle
    used_modules: check_cache,code_style_check,unit_tests
    remote_shell_script: 'https://raw.githubusercontent.com/shadow-robot/sr-build-tools/$toolset_branch/bin/sr-run-ci-build.sh'
dependencies:
  cache_directories:
    - "~/docker"
  post:
    - sudo apt-get update && sudo apt-get install bc jq && pip install requests
    - curl https://sdk.cloud.google.com | bash
    - bin/setup-circleci-secrets "$SECRET_PASSWORD"

test:
  override:
    - curl -s "$( echo "$remote_shell_script" | sed 's/#/%23/g' )" | bash /dev/stdin "$toolset_branch" $server_type $used_modules

